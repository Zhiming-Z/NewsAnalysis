# 热点新闻爬取与展示系统 - 技术方案文档

## 1. 项目概述

### 1.1 项目背景

开发一个热点新闻爬取与展示系统，能够自动获取最新的热点新闻，并按照不同类别在前端页面进行展示。

### 1.2 核心功能

- 多源新闻数据爬取
- 新闻自动分类（经济、政治、艺术、科技、体育等）
- 前端响应式展示
- 搜索和筛选功能

---

## 2. 技术选型

### 2.1 后端技术栈

| 组件 | 技术选择 | 选择理由 |
|------|----------|----------|
| **编程语言** | Python 3.11+ | 丰富的爬虫生态、成熟的数据处理能力 |
| **Web框架** | FastAPI | 高性能、自动生成 API 文档、异步支持 |
| **爬虫框架** | Scrapy + Selenium | Scrapy 高效批量爬取，Selenium 处理动态页面 |
| **任务调度** | Celery + Redis | 分布式任务队列，支持定时任务 |
| **缓存** | Redis | 高性能缓存，支持数据去重 |

### 2.2 数据库方案

| 组件 | 技术选择 | 选择理由 |
|------|----------|----------|
| **主数据库** | PostgreSQL 15+ | 稳定可靠、支持全文搜索、JSON 字段支持 |
| **搜索引擎** | Elasticsearch (可选) | 大规模新闻搜索优化 |

### 2.3 前端技术栈

| 组件 | 技术选择 | 选择理由 |
|------|----------|----------|
| **框架** | Vue.js 3 + TypeScript | 轻量、易学、组件化开发 |
| **UI库** | Element Plus | 丰富的组件库、良好的中文支持 |
| **状态管理** | Pinia | Vue 3 官方推荐、简洁易用 |
| **HTTP客户端** | Axios | 功能完善、拦截器支持 |
| **构建工具** | Vite | 快速的开发构建体验 |

### 2.4 部署方案

| 组件 | 技术选择 | 选择理由 |
|------|----------|----------|
| **容器化** | Docker + Docker Compose | 环境一致性、便于部署 |
| **Web服务器** | Nginx | 反向代理、静态资源服务 |
| **进程管理** | Supervisor / PM2 | 后端服务进程管理 |

---

## 3. 系统架构

### 3.1 整体架构图

```
┌─────────────────────────────────────────────────────────────────────────┐
│                              用户层                                      │
│                         ┌─────────────┐                                  │
│                         │   浏览器     │                                  │
│                         └──────┬──────┘                                  │
└────────────────────────────────┼────────────────────────────────────────┘
                                 │
┌────────────────────────────────┼────────────────────────────────────────┐
│                              接入层                                      │
│                         ┌──────┴──────┐                                  │
│                         │    Nginx    │                                  │
│                         └──────┬──────┘                                  │
└────────────────────────────────┼────────────────────────────────────────┘
                                 │
         ┌───────────────────────┴───────────────────────┐
         │                                               │
         ▼                                               ▼
┌─────────────────────────┐                 ┌─────────────────────────┐
│       前端服务层         │                 │       后端服务层         │
│  ┌───────────────────┐  │                 │  ┌───────────────────┐  │
│  │   Vue.js 前端     │  │                 │  │  FastAPI 后端     │  │
│  │   (静态资源)      │  │                 │  │  (RESTful API)    │  │
│  └───────────────────┘  │                 │  └─────────┬─────────┘  │
└─────────────────────────┘                 │            │            │
                                            │  ┌─────────┴─────────┐  │
                                            │  │   业务逻辑层       │  │
                                            │  │  - 新闻服务       │  │
                                            │  │  - 分类服务       │  │
                                            │  │  - 搜索服务       │  │
                                            │  └───────────────────┘  │
                                            └─────────────────────────┘
                                                         │
┌────────────────────────────────────────────────────────┼────────────────┐
│                              数据层                     │                │
│         ┌──────────────────────────────────────────────┘                │
│         │                                                               │
│         ▼                                                               │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                  │
│  │ PostgreSQL  │    │    Redis    │    │ Elasticsearch│                 │
│  │  (主数据库)  │    │   (缓存)    │    │  (搜索-可选) │                 │
│  └─────────────┘    └─────────────┘    └─────────────┘                  │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│                              爬虫层                                      │
│  ┌───────────────────────────────────────────────────────────────────┐  │
│  │                        Celery Worker                               │  │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                 │  │
│  │  │ Scrapy 爬虫  │  │ Selenium    │  │  数据清洗    │                │  │
│  │  │ (静态页面)   │  │ (动态页面)   │  │  (去重/分类) │                │  │
│  │  └─────────────┘  └─────────────┘  └─────────────┘                 │  │
│  └───────────────────────────────────────────────────────────────────┘  │
│                                │                                        │
│                         ┌──────┴──────┐                                 │
│                         │ Celery Beat │ (定时调度)                      │
│                         └─────────────┘                                 │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│                           外部新闻源                                     │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐       │
│  │ 新浪新闻 │  │ 网易新闻 │  │ 腾讯新闻 │  │ 今日头条 │  │ 其他源   │      │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘       │
└─────────────────────────────────────────────────────────────────────────┘
```

### 3.2 数据流程图

```
┌─────────────────────────────────────────────────────────────────────────┐
│                           数据流程                                       │
└─────────────────────────────────────────────────────────────────────────┘

  ┌──────────┐     ┌──────────┐     ┌──────────┐     ┌──────────┐
  │ 定时触发  │ ──► │ 爬虫采集  │ ──► │ 数据清洗  │ ──► │ 数据去重  │
  └──────────┘     └──────────┘     └──────────┘     └──────────┘
                                                           │
                                                           ▼
  ┌──────────┐     ┌──────────┐     ┌──────────┐     ┌──────────┐
  │ 前端展示  │ ◄── │ API 查询  │ ◄── │ 数据存储  │ ◄── │ 自动分类  │
  └──────────┘     └──────────┘     └──────────┘     └──────────┘

详细流程说明：
1. 定时触发：Celery Beat 按配置的时间间隔触发爬虫任务
2. 爬虫采集：Scrapy/Selenium 从各新闻源获取原始数据
3. 数据清洗：提取标题、内容、时间、来源等字段
4. 数据去重：通过 URL 和标题 Hash 进行去重
5. 自动分类：基于关键词和规则进行新闻分类
6. 数据存储：写入 PostgreSQL 数据库
7. API 查询：FastAPI 提供 RESTful 接口
8. 前端展示：Vue.js 前端渲染展示
```

### 3.3 模块划分

```
hot-news-system/
├── backend/                    # 后端服务
│   ├── app/
│   │   ├── api/               # API 路由
│   │   │   ├── v1/
│   │   │   │   ├── news.py    # 新闻接口
│   │   │   │   ├── category.py # 分类接口
│   │   │   │   └── search.py  # 搜索接口
│   │   │   └── deps.py        # 依赖注入
│   │   ├── core/              # 核心配置
│   │   │   ├── config.py      # 配置管理
│   │   │   └── security.py    # 安全配置
│   │   ├── models/            # 数据模型
│   │   │   ├── news.py        # 新闻模型
│   │   │   └── category.py    # 分类模型
│   │   ├── schemas/           # Pydantic 模式
│   │   │   ├── news.py
│   │   │   └── category.py
│   │   ├── services/          # 业务逻辑
│   │   │   ├── news_service.py
│   │   │   └── category_service.py
│   │   └── main.py            # 应用入口
│   ├── requirements.txt
│   └── Dockerfile
│
├── crawler/                    # 爬虫服务
│   ├── spiders/               # 爬虫定义
│   │   ├── sina_spider.py
│   │   ├── netease_spider.py
│   │   └── tencent_spider.py
│   ├── pipelines/             # 数据管道
│   │   ├── clean_pipeline.py
│   │   ├── dedup_pipeline.py
│   │   └── classify_pipeline.py
│   ├── tasks/                 # Celery 任务
│   │   └── crawl_tasks.py
│   ├── scrapy.cfg
│   └── Dockerfile
│
├── frontend/                   # 前端服务
│   ├── src/
│   │   ├── api/               # API 调用
│   │   ├── components/        # Vue 组件
│   │   ├── views/             # 页面视图
│   │   ├── stores/            # Pinia 状态
│   │   ├── router/            # 路由配置
│   │   └── App.vue
│   ├── package.json
│   └── Dockerfile
│
├── docker-compose.yml          # Docker 编排
├── nginx.conf                  # Nginx 配置
└── README.md                   # 项目说明
```

---

## 4. 新闻源调研

### 4.1 推荐新闻源

| 新闻源 | 类型 | 数据获取方式 | 优先级 |
|--------|------|--------------|--------|
| **新浪新闻** | 综合 | RSS/API | 高 |
| **网易新闻** | 综合 | HTML 解析 | 高 |
| **腾讯新闻** | 综合 | HTML 解析/API | 高 |
| **今日头条** | 综合 | API (需模拟) | 中 |
| **澎湃新闻** | 时政 | HTML 解析 | 中 |
| **36氪** | 科技 | RSS/API | 中 |
| **虎扑体育** | 体育 | HTML 解析 | 中 |
| **财新网** | 财经 | HTML 解析 | 中 |

### 4.2 数据结构分析

各新闻源的通用数据字段：

```json
{
  "title": "新闻标题",
  "content": "新闻正文内容",
  "summary": "新闻摘要",
  "source": "来源网站",
  "source_url": "原文链接",
  "author": "作者",
  "publish_time": "发布时间",
  "images": ["图片URL列表"],
  "tags": ["标签列表"],
  "category": "分类"
}
```

### 4.3 新闻分类规则

基于关键词的分类规则：

| 分类 | 关键词示例 |
|------|-----------|
| **经济** | 股市、财经、金融、GDP、贸易、投资、银行、基金 |
| **政治** | 政府、政策、外交、会议、领导人、选举、法律 |
| **科技** | AI、人工智能、互联网、芯片、5G、新能源、科技 |
| **体育** | 足球、篮球、奥运、世界杯、比赛、运动员、赛事 |
| **艺术** | 电影、音乐、艺术、文化、展览、演出、明星 |
| **其他** | 不匹配以上分类的新闻 |

---

## 5. 非功能性需求

### 5.1 性能要求

| 指标 | 要求 |
|------|------|
| API 响应时间 | < 200ms (P95) |
| 爬虫采集频率 | 每30分钟一次 |
| 单次爬取数量 | 100-500 条 |
| 并发用户数 | 支持 1000+ |

### 5.2 安全要求

- 爬虫遵守 robots.txt 协议
- 设置合理的爬取频率，避免对源站造成压力
- API 接口添加速率限制
- 敏感配置使用环境变量

### 5.3 可扩展性

- 支持动态添加新的新闻源
- 支持自定义分类规则
- 数据库支持水平扩展
- 爬虫服务支持分布式部署

---

## 6. 风险评估

| 风险 | 影响 | 应对措施 |
|------|------|----------|
| 新闻源结构变化 | 爬取失败 | 模块化爬虫设计，便于快速修复 |
| 被源站封禁 | 无法获取数据 | 使用代理池、控制爬取频率 |
| 数据量增长过快 | 存储压力 | 定期清理过期数据、分库分表 |
| 分类准确率低 | 用户体验差 | 引入机器学习分类、人工审核 |

---

## 7. 里程碑计划

### 7.1 阶段总览

| 阶段 | 名称 | 主要目标 | 交付物 | 状态 |
|------|------|----------|--------|------|
| **阶段1** | 需求分析与设计 | 完成技术方案和接口设计 | 设计文档集 | ✅ 已完成 |
| **阶段2** | 爬虫开发 | 实现多源新闻数据采集 | 爬虫服务模块 | 🔲 待开发 |
| **阶段3** | 后端 API 开发 | 实现数据存储和查询服务 | RESTful API 服务 | 🔲 待开发 |
| **阶段4** | 前端开发 | 实现新闻展示界面 | Vue.js 前端应用 | 🔲 待开发 |
| **阶段5** | 测试与优化 | 保障系统质量和性能 | 测试报告 | 🔲 待开发 |
| **阶段6** | 部署上线 | 系统正式运行 | 生产环境 | 🔲 待开发 |

---

### 7.2 阶段1：需求分析与设计 ✅

**目标**：完成系统整体设计，为后续开发奠定基础

| 任务项 | 详细说明 | 交付物 | 状态 |
|--------|----------|--------|------|
| 需求分析 | 分析项目功能需求，确定系统边界和核心功能 | 需求规格说明 | ✅ |
| 技术选型 | 评估并确定前端、后端、数据库、爬虫技术栈 | 技术选型报告 | ✅ |
| 架构设计 | 设计系统整体架构、模块划分、数据流程 | 架构设计文档 | ✅ |
| API 设计 | 设计 RESTful API 接口规范、请求响应格式 | API 接口文档 | ✅ |
| 数据库设计 | 设计数据库表结构、索引、缓存策略 | 数据库设计文档 | ✅ |
| 新闻源调研 | 调研目标新闻网站，分析数据结构和爬取策略 | 新闻源调研报告 | ✅ |

**已交付文档**：
- `docs/technical-solution.md` - 技术方案文档
- `docs/api-documentation.md` - API 接口文档
- `docs/database-design.md` - 数据库设计文档
- `docs/architecture-diagram.md` - 系统架构图

---

### 7.3 阶段2：爬虫开发 🔲

**目标**：实现稳定高效的多源新闻数据采集系统

| 任务项 | 详细说明 | 交付物 | 状态 |
|--------|----------|--------|------|
| 项目框架搭建 | 搭建 Scrapy 项目结构，配置基础设置 | 爬虫项目框架 | 🔲 |
| 新浪爬虫开发 | 实现新浪新闻数据采集（静态页面） | sina_spider.py | 🔲 |
| 网易爬虫开发 | 实现网易新闻数据采集 | netease_spider.py | 🔲 |
| 腾讯爬虫开发 | 实现腾讯新闻数据采集 | tencent_spider.py | 🔲 |
| 动态页面处理 | 集成 Selenium 处理 JavaScript 渲染页面 | Selenium 爬虫模块 | 🔲 |
| 数据清洗 Pipeline | 实现数据提取、清洗、格式化 | clean_pipeline.py | 🔲 |
| 数据去重 Pipeline | 基于 URL Hash 和标题 Hash 进行去重 | dedup_pipeline.py | 🔲 |
| 自动分类 Pipeline | 基于关键词规则实现新闻自动分类 | classify_pipeline.py | 🔲 |
| 定时任务配置 | 配置 Celery + Celery Beat 实现定时爬取 | celery_config.py | 🔲 |
| 日志与监控 | 实现爬取日志记录、异常告警 | 日志模块 | 🔲 |

**预期交付物**：
- 完整的 `crawler/` 服务目录
- 支持 3+ 新闻源的爬虫
- 每 30 分钟自动爬取一次
- 爬取日志和统计功能

---

### 7.4 阶段3：后端 API 开发 🔲

**目标**：实现高性能的新闻数据存储和查询服务

| 任务项 | 详细说明 | 交付物 | 状态 |
|--------|----------|--------|------|
| 项目框架搭建 | 搭建 FastAPI 项目结构，配置依赖 | 后端项目框架 | 🔲 |
| 数据库配置 | 配置 PostgreSQL 连接，实现 ORM 模型 | models/ 目录 | 🔲 |
| 新闻 API | 实现新闻列表、详情、热门、最新接口 | api/v1/news.py | 🔲 |
| 分类 API | 实现分类列表、分类详情、分类新闻接口 | api/v1/category.py | 🔲 |
| 搜索 API | 实现关键词搜索、热门搜索词接口 | api/v1/search.py | 🔲 |
| 标签 API | 实现标签列表、标签新闻接口 | api/v1/tags.py | 🔲 |
| 统计 API | 实现总体统计、分类统计接口 | api/v1/stats.py | 🔲 |
| 缓存集成 | 集成 Redis 缓存，提升查询性能 | cache 模块 | 🔲 |
| 错误处理 | 实现统一错误处理、速率限制 | middleware 模块 | 🔲 |
| API 测试 | 编写 API 单元测试和集成测试 | tests/ 目录 | 🔲 |

**预期交付物**：
- 完整的 `backend/` 服务目录
- 符合 RESTful 规范的 API 接口
- API 响应时间 < 200ms (P95)
- 完整的 API 测试覆盖

---

### 7.5 阶段4：前端开发 🔲

**目标**：实现美观、易用、响应式的新闻展示界面

| 任务项 | 详细说明 | 交付物 | 状态 |
|--------|----------|--------|------|
| 项目框架搭建 | 搭建 Vue.js 3 + TypeScript + Vite 项目 | 前端项目框架 | 🔲 |
| UI 组件集成 | 集成 Element Plus，配置主题样式 | UI 配置 | 🔲 |
| 首页开发 | 实现轮播图、热门新闻、分类展示 | views/Home.vue | 🔲 |
| 新闻列表页 | 实现分页、筛选、排序功能 | views/NewsList.vue | 🔲 |
| 新闻详情页 | 实现正文展示、相关推荐 | views/NewsDetail.vue | 🔲 |
| 分类页面 | 实现按类别浏览新闻 | views/Category.vue | 🔲 |
| 搜索功能 | 实现搜索框、搜索结果、热门搜索 | views/Search.vue | 🔲 |
| 状态管理 | 配置 Pinia 管理全局状态 | stores/ 目录 | 🔲 |
| 响应式适配 | 适配 PC、平板、手机等设备 | 响应式样式 | 🔲 |
| 性能优化 | 代码分割、懒加载、图片优化 | 优化配置 | 🔲 |

**预期交付物**：
- 完整的 `frontend/` 应用目录
- 响应式设计，支持多端访问
- 新闻卡片展示（标题、摘要、来源、时间）
- 搜索和筛选功能

---

### 7.6 阶段5：测试与优化 🔲

**目标**：确保系统稳定性、可靠性和高性能

| 任务项 | 详细说明 | 交付物 | 状态 |
|--------|----------|--------|------|
| 单元测试 | 编写后端服务和爬虫的单元测试 | 单元测试报告 | 🔲 |
| 集成测试 | 进行 API 接口集成测试 | 集成测试报告 | 🔲 |
| 前端测试 | 进行组件测试和 E2E 测试 | 前端测试报告 | 🔲 |
| 爬虫测试 | 测试爬虫稳定性、数据准确性 | 爬虫测试报告 | 🔲 |
| 性能测试 | 压力测试，验证 1000+ 并发支持 | 性能测试报告 | 🔲 |
| 数据库优化 | 优化查询、调整索引、分析慢查询 | 优化报告 | 🔲 |
| 前端优化 | 优化加载速度、减少资源体积 | 优化报告 | 🔲 |
| Bug 修复 | 修复测试发现的所有问题 | Bug 修复记录 | 🔲 |
| 安全检查 | SQL 注入、XSS、CSRF 等安全检查 | 安全检查报告 | 🔲 |

**预期交付物**：
- 完整的测试报告集
- API 响应时间 < 200ms (P95)
- 系统支持 1000+ 并发用户
- 零高危安全漏洞

---

### 7.7 阶段6：部署上线 🔲

**目标**：系统正式上线运行，提供稳定服务

| 任务项 | 详细说明 | 交付物 | 状态 |
|--------|----------|--------|------|
| Docker 配置 | 编写各服务 Dockerfile | Dockerfile 文件 | 🔲 |
| 编排配置 | 编写 docker-compose.yml | docker-compose.yml | 🔲 |
| Nginx 配置 | 配置反向代理、SSL、静态资源 | nginx.conf | 🔲 |
| 数据库部署 | 部署 PostgreSQL，初始化数据 | 数据库实例 | 🔲 |
| 缓存部署 | 部署 Redis 缓存服务 | Redis 实例 | 🔲 |
| 服务部署 | 部署爬虫、后端、前端服务 | 运行中的服务 | 🔲 |
| 监控配置 | 配置日志收集、性能监控、告警 | 监控系统 | 🔲 |
| 运维文档 | 编写部署手册、运维手册 | 运维文档 | 🔲 |
| 上线验证 | 进行生产环境功能验证 | 验证报告 | 🔲 |
| 正式上线 | 开放用户访问，系统正式运行 | 生产环境 | 🔲 |

**预期交付物**：
- 生产环境完整部署
- Docker 容器化部署配置
- 运维文档和部署手册
- 监控和告警系统

---

## 附录

### A. 参考资料

- [FastAPI 官方文档](https://fastapi.tiangolo.com/)
- [Scrapy 官方文档](https://docs.scrapy.org/)
- [Vue.js 官方文档](https://vuejs.org/)
- [PostgreSQL 文档](https://www.postgresql.org/docs/)

### B. 文档版本

| 版本 | 日期 | 修改说明 | 作者 |
|------|------|----------|------|
| v1.0 | 2026-01-30 | 初始版本 | - |
